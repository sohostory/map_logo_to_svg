<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DC Logo Optimizer</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        #preview-container { display: flex; gap: 20px; margin-top: 20px; }
        .preview { border: 1px solid #ddd; width: 200px; height: 200px; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>
    <h1>Data Center Logo Optimizer</h1>
    <input type="file" id="file-input" accept="image/*"><br>
    <input type="text" id="dc-name" placeholder="Enter Data Center Name"><br>
    <button id="convert-btn">Convert to SVG</button>

    <div id="preview-container">
        <div class="preview" id="original-preview">Original</div>
        <div class="preview" id="output-preview">Output</div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/svgo/dist/svgo.browser.min.js"></script>
    <script>
        const fileInput = document.getElementById('file-input');
        const dcNameInput = document.getElementById('dc-name');
        const originalPreview = document.getElementById('original-preview');
        const outputPreview = document.getElementById('output-preview');
        const convertBtn = document.getElementById('convert-btn');

        let uploadedImage;

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            uploadedImage = file;
            const reader = new FileReader();
            reader.onload = (event) => {
                originalPreview.innerHTML = `<img src="${event.target.result}" style="max-width: 100%; max-height: 100%;">`;
            };
            reader.readAsDataURL(file);
        });

        convertBtn.addEventListener('click', async () => {
            if (!uploadedImage || !dcNameInput.value) {
                alert('Please upload an image and enter a data center name.');
                return;
            }

            const img = new Image();
            img.src = URL.createObjectURL(uploadedImage);
            img.onload = async () => {
                const canvas = document.createElement('canvas');
                canvas.width = 100;
                canvas.height = 100;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, 100, 100);

                const svgData = `
<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
    <image href="${canvas.toDataURL()}" width="100" height="100"/>
</svg>`;

                const result = await window.svgo.optimize(svgData, { multipass: true });
                const svgBlob = new Blob([result.data], { type: 'image/svg+xml' });

                if (svgBlob.size > 30000) {
                    alert('Export file is larger than 30KB. Please try a smaller image or compress further.');
                    return;
                }

                const fileName = `${dcNameInput.value}_mapLogo_optimized.svg`;
                const url = URL.createObjectURL(svgBlob);
                outputPreview.innerHTML = `<img src="${url}" style="max-width: 100%; max-height: 100%;">`;

                const link = document.createElement('a');
                link.href = url;
                link.download = fileName;
                link.textContent = 'Download Optimized SVG';
                outputPreview.appendChild(link);
            };
        });
    </script>
</body>
</html>